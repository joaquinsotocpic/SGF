<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>SGF v1.32.6 - Sistema de Gestión Financiera</title>

  <!-- Tailwind CSS (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Lucide Icons -->
  <script src="https://unpkg.com/lucide@latest"></script>

  <!-- Flatpickr (Date picker) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/es.js"></script>

  <!-- CryptoJS (cifrado bóveda) -->
  <script src="https://cdn.jsdelivr.net/npm/crypto-js@4.2.0/crypto-js.min.js"></script>
  <!-- sql.js (SQLite en navegador) -->
  <script src="https://cdn.jsdelivr.net/npm/sql.js@1.10.2/dist/sql-wasm.js"></script>

  <!-- CSS (Opción 3) -->
  <link rel="stylesheet" href="assets/css/base.css" />
  <link rel="stylesheet" href="assets/css/themes.css" />
  <link rel="stylesheet" href="assets/css/components.css" />
</head>
<body class="bg-gray-50 text-gray-900 font-sans">

  <!-- CONTENEDOR DE LOGIN -->
  <div id="login-container" class="flex items-center justify-center min-h-screen">
    <div class="bg-white p-8 rounded-xl shadow-2xl w-full max-w-md">
      <div class="flex flex-col items-center mb-6">
        <div class="p-3 bg-blue-600 rounded-full mb-4">
          <i data-lucide="lock" class="text-white w-8 h-8"></i>
        </div>
        <h1 class="text-2xl font-bold">Bienvenido</h1>
        <p class="text-gray-500 text-sm">Inicia sesión para acceder al sistema</p>
        <p class="text-gray-400 text-xs mt-1">Versión <span id="sgf-version">—</span></p>
      </div>
      <form id="login-form" class="space-y-4">
        <div>
          <label class="block text-sm font-medium mb-1">Digite usuario</label>
          <input type="text" id="username" class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-500" required placeholder="Digite usuario">


        </div>
        <div>
          <label class="block text-sm font-medium mb-1">Contraseña</label>
          <input type="password" id="password" class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-500" required minlength="6" placeholder="Mínimo 6 caracteres" value="" />
        </div>
        <button id="btn-open" type="submit" class="w-full bg-blue-600 text-white py-2 rounded-lg font-semibold hover:bg-blue-700 transition flex items-center justify-center gap-2">
          <span>Entrar</span>
        </button>
        <button id="btn-create" type="button" class="w-full bg-slate-900 text-white py-2 rounded-lg font-semibold hover:bg-slate-800 transition flex items-center justify-center gap-2">
          <span>Crear usuario</span>
        </button>
      </form>

      <div class="mt-4 space-y-2">
        <button id="btn-delete-all" type="button" class="w-full border border-red-200 text-red-600 py-2 rounded-lg font-semibold hover:bg-red-50 transition flex items-center justify-center gap-2">
          <i data-lucide="trash" class="w-4 h-4"></i>
          <span>Eliminar usuarios (este dispositivo)</span>
        </button>
        <p class="text-xs text-gray-400 text-center">La base local se cifra con la contraseña. Si la contraseña es incorrecta, no se puede abrir.</p>
      </div>
    </div>
  </div>

  <!-- CONTENEDOR PRINCIPAL -->
  <div id="app-container" class="hidden flex min-h-screen">

    <!-- SIDEBAR -->
    <aside id="sidebar" class="bg-slate-900 text-white sidebar-transition w-64 flex flex-col fixed h-full z-30 -translate-x-full lg:translate-x-0">
      <div class="p-4 flex items-center justify-between border-b border-slate-800">
                <div class="flex items-baseline gap-2">
                  <span class="text-xl font-bold truncate">SGF</span>
                  <span class="text-[10px] px-2 py-0.5 rounded bg-slate-800 text-slate-200 font-bold" id="app-version">v1.19.28</span>
                </div>
        <button onclick="toggleSidebar()" class="lg:hidden"><i data-lucide="x"></i></button>
      </div>

      <nav class="flex-1 p-4 space-y-2 overflow-y-auto">
        <a href="#" onclick="showSection('dashboard')" class="flex items-center space-x-3 p-2 rounded-lg hover:bg-slate-800 transition">
          <i data-lucide="layout-dashboard"></i><span>Dashboard</span>
        </a>
        <a href="#" onclick="showSection('movimientos')" class="flex items-center space-x-3 p-2 rounded-lg hover:bg-slate-800 transition">
          <i data-lucide="list"></i><span>Movimientos</span>
        </a>
        <a href="#" onclick="showSection('ahorros')" class="flex items-center space-x-3 p-2 rounded-lg hover:bg-slate-800 transition">
          <i data-lucide="piggy-bank"></i><span>Ahorros</span>
        </a>
        <a href="#" onclick="showSection('presupuestos')" class="flex items-center space-x-3 p-2 rounded-lg hover:bg-slate-800 transition">
          <i data-lucide="pie-chart"></i><span>Presupuestos</span>
        </a>
        <a href="#" onclick="showSection('conciliacion')" class="flex items-center space-x-3 p-2 rounded-lg hover:bg-slate-800 transition">
          <i data-lucide="file-text"></i><span>Conciliación</span>
        </a>

        <div class="space-y-1">
          <button type="button" onclick="toggleDropdown('menu-reportes')" class="w-full flex items-center justify-between p-2 rounded-lg hover:bg-slate-800 transition">
            <span class="flex items-center space-x-3">
              <i data-lucide="bar-chart-3"></i><span>Reportes</span>
            </span>
            <i data-lucide="chevron-down" class="w-4 h-4 opacity-80"></i>
          </button>
          <div id="menu-reportes" class="hidden pl-9 space-y-1">
            <a href="#" onclick="showSection('reportes_resumen_cuentas')" class="block p-2 rounded-lg hover:bg-slate-800 transition text-sm">
              Resumen por cuentas
            </a>
            <a href="#" onclick="showSection('reportes_resumen_categorias')" class="block p-2 rounded-lg hover:bg-slate-800 transition text-sm">
              Resumen por categorías
            </a>
            <a href="#" onclick="showSection('reportes_estado_resultados')" class="block p-2 rounded-lg hover:bg-slate-800 transition text-sm">
              Estado de Resultados
            </a>
            <a href="#" onclick="showSection('reportes_flujo_caja')" class="block p-2 rounded-lg hover:bg-slate-800 transition text-sm">
              Flujo de Caja
            </a>
            <a href="#" onclick="showSection('reportes_presupuesto_vs_real')" class="block p-2 rounded-lg hover:bg-slate-800 transition text-sm">
              Presupuesto vs Real
            </a>
            <a href="#" onclick="showSection('reportes_tendencias_12m')" class="block p-2 rounded-lg hover:bg-slate-800 transition text-sm">
              Tendencias (12 meses)
            </a>
            <a href="#" onclick="showSection('reportes_insights')" class="block p-2 rounded-lg hover:bg-slate-800 transition text-sm">
              Insights
            </a>
            <a href="#" onclick="showSection('reportes_comparativo_mes')" class="block p-2 rounded-lg hover:bg-slate-800 transition text-sm">
              Comparativo Mes a Mes
            </a>
            <a href="#" onclick="showSection('reportes_balance_cuentas')" class="block p-2 rounded-lg hover:bg-slate-800 transition text-sm">
              Balance por Cuenta
            </a>
          </div>
        </div>


        <div class="relative">
          <button onclick="toggleDropdown('cat-drop')" class="w-full flex items-center justify-between p-2 rounded-lg hover:bg-slate-800 transition">
            <div class="flex items-center space-x-3"><i data-lucide="layers"></i><span>Catálogos</span></div>
            <i data-lucide="chevron-down" class="w-4 h-4"></i>
          </button>
          <div id="cat-drop" class="hidden pl-10 mt-1 space-y-1">
            <a href="#" onclick="showSection('cuentas')" class="block p-2 text-sm text-slate-400 hover:text-white">Cuentas</a>
            <a href="#" onclick="showSection('tipos')" class="block p-2 text-sm text-slate-400 hover:text-white">Tipos de Cuenta</a>
            <a href="#" onclick="showSection('categorias')" class="block p-2 text-sm text-slate-400 hover:text-white">Categorías</a>
          </div>
        </div>

        <div class="pt-4 border-t border-slate-800 mt-4">
          <a href="#" onclick="showSection('config')" class="flex items-center space-x-3 p-2 rounded-lg hover:bg-slate-800 transition text-slate-300">
            <i data-lucide="settings"></i><span>Configuración</span>
          </a>
          <a href="#" onclick="logout()" class="flex items-center space-x-3 p-2 rounded-lg hover:bg-red-900/30 transition text-red-400">
            <i data-lucide="log-out"></i><span>Cerrar Sesión</span>
          </a>
        </div>
      </nav>
    </aside>

    <!-- CONTENIDO -->
    <main class="flex-1 lg:ml-64 bg-gray-100 flex flex-col min-w-0">
      <header class="bg-white shadow-sm p-4 flex items-center justify-between sticky top-0 z-20">
        <button onclick="toggleSidebar()" class="lg:hidden text-gray-600"><i data-lucide="menu"></i></button>
        <h2 id="section-title" class="text-xl font-semibold">Dashboard</h2>
        <div class="flex items-center space-x-3">
          <button id="btn-save-session" type="button" class="hidden sm:inline-flex items-center gap-2 px-3 py-2 rounded-lg bg-blue-600 text-white text-sm font-semibold hover:bg-blue-700">
            <i data-lucide="save" class="w-4 h-4"></i><span>Guardar</span>
          </button>
          <button id="btn-export-vault" type="button" class="hidden sm:inline-flex items-center gap-2 px-3 py-2 rounded-lg bg-gray-200 text-gray-800 text-sm font-semibold hover:bg-gray-300">
            <i data-lucide="download" class="w-4 h-4"></i><span>Exportar BD</span>
          </button>
          <span id="user-display" class="text-sm font-medium text-gray-700 hidden sm:block">—</span>
          <div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center">
            <i data-lucide="user" class="text-blue-600"></i>
          </div>
        </div>
      </header>

      <div id="content-area" class="p-6 overflow-y-auto">
        <!-- Aquí se inyectan las vistas (Opción 3) -->
        <div id="view-root"></div>
      </div>
    </main>
  </div>

  <!-- TOAST -->
  <div id="toast" class="hidden fixed bottom-5 right-5 bg-slate-900 text-white px-4 py-2 rounded-lg shadow-lg text-sm z-[60]"></div>

  <!-- MODAL (global) -->
  <!--
    UI/UX: evitar recorte arriba/abajo cuando el contenido del modal excede la altura.
    - overlay con scroll vertical
    - contenedor con max-height
    - cuerpo del modal scrolleable
    - header sticky
  -->
  <div id="modal-overlay" class="fixed inset-0 bg-black/50 hidden z-50 overflow-y-auto">
    <div class="min-h-full w-full flex items-start justify-center p-4 sm:p-6">
      <div class="bg-white rounded-xl shadow-2xl w-full max-w-4xl lg:max-w-5xl 2xl:max-w-6xl overflow-hidden max-h-[calc(100vh-3rem)] flex flex-col">
        <div class="bg-gray-50 p-4 border-b flex justify-between items-center sticky top-0 z-10">
        <h3 id="modal-title" class="font-bold text-lg text-gray-800">Acción</h3>
        <button onclick="closeModal()"><i data-lucide="x"></i></button>
        </div>
        <div class="p-4 sm:p-6 overflow-y-auto">
          <div id="modal-body" class="space-y-5 sm:space-y-6"></div>
          <div class="flex justify-end space-x-3 pt-4 border-t mt-6">
            <button type="button" onclick="closeModal()" class="px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg">Cancelar</button>
            <button id="modal-save" type="button" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 shadow-md">Guardar</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- JS (Opción 3) -->

  <!-- Vistas embebidas (fallback para file:// sin fetch) -->
  
  
  
  
  
  
  
  
  
  


  <script src="assets/js/app/db.js"></script>
  <script src="assets/js/app/migrate.js"></script>
<script src="assets/js/app/closure.guard.js"></script>
  <script src="assets/js/app/data.maintenance.js"></script>
  <script src="assets/js/app/vault.js"></script>
  <script src="assets/js/app/format.js"></script>
  <script src="assets/js/app/fx.js"></script>
  <script src="assets/js/app/router.js"></script>
  <script src="assets/js/ui/sidebar.js"></script>
  <script src="assets/js/ui/table.js"></script>
  <script src="assets/js/ui/tree.js"></script>
  <script src="assets/js/ui/modal.js"></script>
  <script src="assets/js/ui/confirm.js"></script>

  <script src="assets/js/modules/dashboard/dashboard.ui.js"></script>
  <script src="assets/js/modules/reportes/reports.common.js"></script>
  <script src="assets/js/modules/reportes/reports.data.js"></script>
  <script src="assets/js/modules/reportes/reports.engine.js"></script>
  <script src="assets/js/modules/reportes/reports.drilldown.js"></script>
  <script src="assets/js/modules/reportes/resumen-cuentas.ui.js"></script>
  <script src="assets/js/modules/reportes/resumen-categorias.ui.js"></script>
  <script src="assets/js/modules/reportes/estado-resultados.ui.js"></script>
  <script src="assets/js/modules/reportes/flujo-caja.ui.js"></script>
  <script src="assets/js/modules/reportes/presupuesto-vs-real.ui.js"></script>
  <script src="assets/js/modules/reportes/tendencias-12m.ui.js"></script>
  <script src="assets/js/modules/reportes/insights.ui.js"></script>
  <script src="assets/js/modules/reportes/comparativo-mes.ui.js"></script>
  <script src="assets/js/modules/reportes/balance-cuentas.ui.js"></script>
  <script src="assets/js/modules/movimientos/movimientos.ui.js"></script>
  <script src="assets/js/modules/ahorros/ahorros.ui.js"></script>
  <script src="assets/js/modules/presupuestos/presupuestos.ui.js"></script>
  <script src="assets/js/modules/conciliacion/conciliacion.ui.js"></script>
  <script src="assets/js/modules/catalogos/catalogos.ui.js"></script>
  <script src="assets/js/modules/config/config.ui.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <script src="assets/js/utils/pdf.util.js"></script>

  <script src="assets/js/app/boot.js"></script>

<!-- SGF inline views (file:// fallback) -->

  

  

  

  

  

  

  

  

  

<!-- /SGF inline views -->

</body>
</html>
